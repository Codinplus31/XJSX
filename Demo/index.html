<!DOCTYPE html>
<html>

<head>
  
  <template id="#">
  <?if: localStorage.user?>
    <?use-template: document.querySelector("template[home]")?>
  <?else?>
    <?use-template: document.querySelector("template[login]")?>
  <?end?>
  </template>
  <template id="#/">
    <?use-template: "#"?>
  </template>
 
  <template login>
    <?if: localStorage.user?>
    <div class="ui message">
      Hello <?data: user?>. want to register again?
    </div>
    <?end?>
    <h1>Register</h1>
    <div class="ui input">
      <input value="" type="text" placeholder="your fake name...">
    </div>
    <br />
  <br />
<div class="ui message error msg" hidden>

</div>
<button class="ui primary button" onclick="submit()">Next</button>
<script type="text/javascript" charset="utf-8">
  var bd = document.querySelector(".msg")
  function error(val) {
    bd.hidden = false
    bd.innerText = val
  }

  function submit(val) {
    var txt = document.querySelector("input"). value.trim()
    if (txt.length < 3) {
      error(`'${txt}' was invalid.\n(#) name should be at least 4 letters long`);
    } else {
      bd.hidden = true
      bd.innerText = "";
      emit('data/user',txt);
      emit('hashchange');
    }
  }

</script>
</template>
  <template home>
  <h1>
    Hello, 
    <?data: user?>
  </h1>
  <p>
    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laudantium necessitatibus architecto ipsa reprehenderit eligendi dolorum consequatur reiciendis! Tempora minus itaque repudiandae debitis, dignissimos voluptatem iste a, porro consequatur eius voluptates.
  </p>
  <button class="ui button" onclick="logout()">Sign out</button>
  <script type="text/javascript" charset="utf-8">
    function logout(argument) {
      emit('data/user',"");
     emit("hashchange")
    }
  </script>
</template>
  <template notfound>
  <h1>
    404
  </h1>
  <p>
    No such route "/<?print: hash?>"
  </p>
  <a href="#" class="ui button primary">Home</a>
</template>

<link rel="stylesheet" type="text/css" href="./dist/semantic.css">
<script type="text/javascript" src="./xjsx.0.0.3.js"></script>
<script type="text/javascript" charset="utf-8">
  var on=XJSX.event.on,
  emit=XJSX.event.emit;
  
 on("data/user",({detail})=>localStorage.user=detail);
 emit('data/user',localStorage.user||"");
 emit("hashchange")
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title></title>
<style>
body {
padding: 1em;
}
.spaced > .button {
margin-bottom: 1em;
}
</style>
 <style>
   .f{
     xtransition: 200ms;
     animation: f 3s linear;
     xopacity: 0;
   }
   @keyframes f{
     from{
       opacity: 0.2;
     }
     to{
       opacity: 1;
     }
   }
 </style>
</head>

<body>

  <div class="ui card">
  <div class="content">
  <?on: "hashchange"?>
    <?eval: 
    var hash=location.hash.trim();
    var tmp=hash||"#";?>
    
    <?eval: 
    tmp= document.querySelector(`template[id="${tmp}"]`)||
    document.querySelector("template[notfound]")?>
    
    <?use-template: tmp?>
  <?end?>
  </div>
  </div>

  <script type="text/javascript" charset="utf-8">

  </script>
</body>
</html>